<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto-Load CSV Randomizer</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; max-width: 600px; margin: 50px auto; background-color: #f4f7f6; color: #2d3436; }
        .card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        h1 { font-size: 1.5rem; margin-bottom: 20px; color: #0984e3; text-align: center; }
        label { display: block; margin-bottom: 8px; font-weight: bold; font-size: 0.9rem; }
        select { width: 100%; padding: 12px; border: 2px solid #dfe6e9; border-radius: 8px; margin-bottom: 20px; outline: none; transition: border-color 0.2s; }
        select:focus { border-color: #0984e3; }
        button { width: 100%; padding: 15px; background: #0984e3; color: white; border: none; border-radius: 8px; font-size: 1rem; font-weight: bold; cursor: pointer; transition: transform 0.1s, background 0.2s; }
        button:hover { background: #74b9ff; }
        button:active { transform: scale(0.98); }
        .result-box { margin-top: 30px; padding: 20px; background: #f9f9f9; border-left: 5px solid #0984e3; border-radius: 4px; min-height: 60px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; text-align: center; }
        .status { font-size: 0.75rem; text-align: center; margin-top: 10px; color: #636e72; }
    </style>
</head>
<body>

<div class="card">
    <h1>Random Entry Picker</h1>
    
    <label for="categoryFilter">Select Category</label>
    <select id="categoryFilter">
        <option value="all">Loading data...</option>
    </select>

    <button id="pickBtn">Randomize</button>

    <div class="result-box" id="result">
        Click the button to pick an entry.
    </div>
    
    <div class="status" id="status">Status: Initializing...</div>
</div>

<script>
    const CSV_URL = 'data.csv'; // <--- MAKE SURE YOUR FILE IS NAMED THIS
    let dataStore = [];
    const filterDropdown = document.getElementById('categoryFilter');
    const pickBtn = document.getElementById('pickBtn');
    const resultDiv = document.getElementById('result');
    const statusDiv = document.getElementById('status');

    // Load data automatically on page load
    window.addEventListener('DOMContentLoaded', () => {
        fetch(CSV_URL)
            .then(response => {
                if (!response.ok) throw new Error("Could not find " + CSV_URL);
                return response.text();
            })
            .then(csvText => processCSV(csvText))
            .catch(err => {
                statusDiv.textContent = "Error: " + err.message;
                statusDiv.style.color = "red";
            });
    });

    function processCSV(csvText) {
        const lines = csvText.split(/\r?\n/).filter(line => line.trim() !== "");
        const categories = new Set();
        dataStore = [];

        // Assuming Row 0 is Headers; start at 1
        for (let i = 1; i < lines.length; i++) {
            const columns = lines[i].split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
            
            if (columns.length >= 2) {
                const category = columns[0].replace(/"/g, "").trim();
                const entry = columns[1].replace(/"/g, "").trim();
                
                if (category) {
                    categories.add(category);
                    dataStore.push({ category, entry });
                }
            }
        }

        // Update Dropdown
        filterDropdown.innerHTML = '<option value="all">-- All Categories --</option>';
        Array.from(categories).sort().forEach(cat => {
            const opt = document.createElement('option');
            opt.value = cat;
            opt.textContent = cat;
            filterDropdown.appendChild(opt);
        });

        statusDiv.textContent = `Status: ${dataStore.length} entries ready.`;
    }

    pickBtn.addEventListener('click', () => {
        const selectedCat = filterDropdown.value;
        const filtered = selectedCat === 'all' 
            ? dataStore 
            : dataStore.filter(item => item.category === selectedCat);

        if (filtered.length > 0) {
            const randomIndex = Math.floor(Math.random() * filtered.length);
            resultDiv.textContent = filtered[randomIndex].entry;
        } else {
            resultDiv.textContent = "No entries available.";
        }
    });
</script>

</body>
</html>
